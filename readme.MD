# ğŸ“Œ Attendance Service API

A Node.js + Express.js backend service for managing employee attendance with MongoDB Atlas as the database.
Supports user authentication, role-based registration (`admin` & `employee`), and attendance tracking (check-in & check-out).

---

## âœ¨ Features

- **User Management**

  - Register as `employee` or `admin`
  - Secure password hashing with `bcrypt`
  - JWT authentication with role-based claims
  - Retrieve all users (without passwords)

- **Attendance Management**

  - Check-in with timestamp and location (latitude & longitude)
  - Check-out with timestamp and location
  - Fetch attendance records by user
  - Fetch all attendance records (admin only)

---

## ğŸ—‚ Project Structure

```
attendance-service/
â”‚â”€â”€ src/
â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â”œâ”€â”€ authController.js     # Register, login, user management
â”‚   â”‚   â””â”€â”€ attendanceController.js # Attendance CRUD
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ User.js               # User schema (username, password, role)
â”‚   â”‚   â””â”€â”€ Attendance.js         # Attendance schema (checkin/checkout)
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ authRoutes.js         # /api/auth endpoints
â”‚   â”‚   â””â”€â”€ attendanceRoutes.js   # /api/attendance endpoints
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ db.js                 # MongoDB connection
â”‚   â””â”€â”€ server.js                 # Express app entry point
â”‚â”€â”€ .env                          # Environment variables
â”‚â”€â”€ package.json
â”‚â”€â”€ README.md
```

---

## âš™ï¸ Installation & Setup

### 1. Clone repository

```bash
git clone https://github.com/your-username/attendance-service.git
cd attendance-service
```

### 2. Install dependencies

```bash
npm install
```

### 3. Configure environment variables

Create a `.env` file:

```env
MONGO_URI=mongodb+srv://<user>:<password>@cluster0.mongodb.net/attendance
JWT_SECRET=supersecretkey
PORT=5000
```

### 4. Run the service

Development:

```bash
npm run dev
```

Production:

```bash
npm start
```

---

## ğŸš€ API Endpoints

### ğŸ” Authentication

| Method | Endpoint                      | Description                 |
| ------ | ----------------------------- | --------------------------- |
| POST   | `/api/auth/register/admin`    | Register a new admin        |
| POST   | `/api/auth/register/employee` | Register a new employee     |
| POST   | `/api/auth/login`             | Login and get JWT token     |
| GET    | `/api/auth/users`             | Get all users (no password) |

---

### ğŸ•’ Attendance

| Method | Endpoint                       | Description                |
| ------ | ------------------------------ | -------------------------- |
| POST   | `/api/attendance/checkin`      | Record employee check-in   |
| POST   | `/api/attendance/checkout`     | Record employee check-out  |
| GET    | `/api/attendance/user/:userId` | Get attendance by user     |
| GET    | `/api/attendance`              | Get all attendance records |

---

## ğŸ“Œ Example Requests

### Register Employee

```http
POST /api/auth/register/employee
Content-Type: application/json

{
  "username": "john",
  "password": "123456"
}
```

### Register Admin

```http
POST /api/auth/register/admin
Content-Type: application/json

{
  "username": "superadmin",
  "password": "123456"
}
```

### Login

```http
POST /api/auth/login
Content-Type: application/json

{
  "username": "john",
  "password": "123456"
}
```

Response:

```json
{
  "token": "xxx.yyy.zzz",
  "role": "employee"
}
```

### Check-in

```http
POST /api/attendance/checkin
Authorization: Bearer <JWT_TOKEN>
Content-Type: application/json

{
  "userId": "68a1e966249c5c781194bd4a",
  "latitude": -6.2,
  "longitude": 106.816666
}
```

---

## ğŸ”’ Security Notes

- Passwords are hashed with `bcrypt` before saving to database.
- JWT tokens include user `id` and `role`.
- You can implement middleware to restrict certain endpoints to `admin` role only (recommended).

---
